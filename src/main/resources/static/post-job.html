<!DOCTYPE html>
<html>
<head>
    <title>Post a Job</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            padding: 20px;
            max-width: 600px;
            margin: auto;
        }

        label {
            display: block;
            margin-top: 15px;
        }

        input, textarea, select {
            width: 100%;
            padding: 8px;
            margin-top: 5px;
            box-sizing: border-box;
        }

        button {
            margin-top: 20px;
            padding: 10px 20px;
            font-size: 16px;
        }

        #logoutBtn {
            float: right;
            background-color: #dc3545;
            color: white;
            border: none;
            padding: 8px 14px;
            cursor: pointer;
            font-weight: bold;
        }

        #logoutBtn:hover {
            background-color: #c82333;
        }

        #jobStatus {
            margin-top: 20px;
            font-weight: bold;
        }
    </style>
</head>
<body>

    <!-- ‚úÖ Logout Button (top-right) -->
    <button id="logoutBtn">Logout</button>

    <h2>Post a New Job</h2>

    <!-- ‚úÖ Job Posting Form -->
    <form id="jobForm">
        <label>Title: <input type="text" name="title" required></label><br>
        <label>Description: <textarea name="description" required></textarea></label><br>
        <label>Type:
            <select name="type">
                <option value="Full Time">Full Time</option>
                <option value="Part Time">Part Time</option>
            </select>
        </label><br>
        <label>Salary: <input type="text" name="salary"></label><br>
        <label>Deadline: <input type="date" name="deadline"></label><br>
        <label>Company Name: <input type="text" name="company_name"></label><br>
        <label>Company Logo URL: <input type="text" name="company_logo"></label><br>
        <label>Location: <input type="text" name="location" required></label><br>
         <label>Category:
    <select name="category">
        <option value="Marketing">Marketing</option>
        <option value="Customer Service">Customer Service</option>
        <option value="Human Resource">Human Resource</option>
        <option value="Project Management">Project Management</option>
        <option value="Business Development">Business Development</option>
        <option value="Sales & Communication">Sales & Communication</option>
        <option value="Teaching & Education">Teaching & Education</option>
        <option value="Design & Creative">Design & Creative</option>
    </select>
</label>

        <button type="submit">Post Job</button>
    </form>

    <p id="jobStatus" style="font-weight: bold; margin-top: 20px;"></p>

    <!-- ‚úÖ Admin Access Check -->
    <script>
        document.addEventListener('DOMContentLoaded', () => {
        const isAdmin = localStorage.getItem('adminAuthenticated') === 'true';
        if (!isAdmin) {
            alert('Only admins can post jobs. Redirecting to login.');
            window.location.href = 'post-job-login.html';
        }


        });
    </script>

    <!-- ‚úÖ Logout Script -->
    <script>
    document.getElementById('logoutBtn').addEventListener('click', () => {
        localStorage.removeItem('adminAuthenticated');
        window.location.href = 'index.html';
    });
    </script>

    <!-- ‚úÖ Submit Form Script -->
    <script>
    document.getElementById('jobForm').addEventListener('submit', function(e) {
        e.preventDefault();
        const formData = new FormData(this);
        const jobData = {};
        formData.forEach((value, key) => jobData[key] = value);

        fetch('http://localhost:8080/api/jobs', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify(jobData)
        })
        .then(async res => {
            if (!res.ok) {
                const text = await res.text();
                throw new Error(`Server error ${res.status}: ${text}`);
            }
            return res.json();
        })
        .then(data => {
            const status = document.getElementById('jobStatus');
            status.style.color = 'green';
            status.innerHTML = `‚úÖ Job posted successfully!<br>üîπ Job ID: <strong>${data.jobId}</strong>`;
            document.getElementById('jobForm').reset();
        })
        .catch(err => {
            console.error('Error posting job:', err);
            const status = document.getElementById('jobStatus');
            status.style.color = 'red';
            status.innerText = '‚ùå Error posting job: ' + err.message;
        });
    });
    </script>

</body>
</html>
